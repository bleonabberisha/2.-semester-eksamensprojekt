---
import Footer from "../components/Footer.astro";
import Navigation from "../components/Navigation.astro";

const url = "https://bmeqborbvkcxawkfcyti.supabase.co/rest/v1/webshop?category=eq.rimini"; // Hent kun "rimini" produkter
const options = {
  headers: {
    apikey: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJtZXFib3JidmtjeGF3a2ZjeXRpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzM3NTAzNjQsImV4cCI6MjA0OTMyNjM2NH0.KlmI1c_Z1pEe-8SBSrlHMo4gvy7nfsLDASpjS2-nFf8",
    "Content-Type": "application/json",
  },
};

let produkter = [];
try {
  const response = await fetch(url, options);
  if (!response.ok) {
    throw new Error(`HTTP-fejl! Status: ${response.status}`);
  }
  produkter = await response.json();
} catch (error) {
  console.error("Fejl ved hentning af data:", error);
}
---

<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Rimini</title>
    <style>
      main {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
        gap: 20px;
        padding: 20px;
        max-width: 1200px;
        margin: 0 auto;
      }
      article {
        overflow: hidden;
        text-align: left;
        position: relative;
        cursor: pointer;
        transition: transform 0.3s ease;
      }
      article:hover {
        transform: scale(1.05);
      }
      article img {
        width: 100%;
        height: auto;
        display: block;
      }
      .price {
        font-size: 1rem;
        font-weight: bold;
        margin-bottom: 10px;
      }
      footer {
        text-align: center;
        padding: 20px;
        background-color: white;
        border-top: 1px solid #ddd;
        font-size: 0.9rem;
        color: #777;
      }

      /* Mobil */
      @media (max-width: 768px) {
        main {
          grid-template-columns: repeat(2, 1fr);
          gap: 10px;
        }
      }
    </style>
  </head>

  <body>
    <header>
      <Navigation />
    </header>
    <main>
      {
        produkter.length > 0 ? (
          produkter.map((produkt) => (
            <article class={produkt.liked ? "liked" : ""}>
              <a href={`/product/${produkt.id}`} style="text-decoration: none; color: inherit;">
                <img src={produkt.picture} alt={produkt.name} />
                <h3>{produkt.name}</h3>
                <p class="price">{produkt.price.toFixed(2).replace(".", ",")} kr.</p>
              </a>
            </article>
          ))
        ) : (
          <p>Ingen produkter fundet.</p>
        )
      }
    </main>
    <Footer />
  </body>
</html>
